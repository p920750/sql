CREATE TABLE ITEMS_CSEA_52(ITEMID NUMBER(7),ITEMNAME VARCHAR(25),CATEGORY VARCHAR(15),PRICE NUMBER(7),INSTOCK INT CHECK(INSTOCK>=0),PRIMARY KEY(ITEMID));
CREATE TABLE CUSTOMERS_CSEA_52(CUSTID NUMBER(7),CUSTNAME VARCHAR(15),ADDRESS VARCHAR(30),STATE VARCHAR(10),PRIMARY KEY(CUSTID));
CREATE TABLE ORDERS_CSEA_52(ORDERID NUMBER(7),ITEMID NUMBER(7),CUSTID NUMBER(7),QUANTITY INT,ORDERDATE DATE,PRIMARY KEY(ORDERID),FOREIGN KEY(ITEMID) REFERENCES ITEMS_CSEA_52(ITEMID),FOREIGN KEY(CUSTID) REFERENCES CUSTOMERS_CSEA_52(CUSTID));
CREATE TABLE DELIVERY_CSEA_52(DELIVERYID NUMBER(7),CUSTID NUMBER(7),ORDERID NUMBER(7),PRIMARY KEY(DELIVERYID),FOREIGN KEY(CUSTID) REFERENCES CUSTOMERS_CSEA_52(CUSTID),FOREIGN KEY(ORDERID) REFERENCES ORDERS_CSEA_52(ORDERID));
DESC ITEMS_CSEA_52;
INSERT INTO ITEMS_CSEA_52 VALUES(1000,'Prestige Cooking Pan','Utensils',4000,3);
INSERT INTO ITEMS_CSEA_52 VALUES(1001,'Samsung Galaxy S4','Smartphones',46000,0);
INSERT INTO ITEMS_CSEA_52 VALUES(1002,'Pureflames Stove','Utensils',38000,6);
INSERT INTO ITEMS_CSEA_52 VALUES(1003,'Samsung Washhing Machine','Home Appliances',49000,0);
INSERT INTO ITEMS_CSEA_52 VALUES(1004,'Kernel Refrigerator','Home Appliances',54000,2);
SELECT * FROM ITEMS_CSEA_52;
DESC CUSTOMERS_CSEA_52;
INSERT INTO CUSTOMERS_CSEA_52 VALUES(2000,'Jennifer James','Room no:45,SK Apartments','New Delhi');
INSERT INTO CUSTOMERS_CSEA_52 VALUES(2001,'Akhil Raj','Matthhil(H)','Kerala');
INSERT INTO CUSTOMERS_CSEA_52 VALUES(2002,'Mickey Johhns','Sardar Colony','Gujarat');
INSERT INTO CUSTOMERS_CSEA_52 VALUES(2003,'Jose Reji','Room no:23,Skyline Apartments','Kerala');
INSERT INTO CUSTOMERS_CSEA_52 VALUES(2004,'William Jacob','Rourkela St','New Delhi');
SELECT * FROM CUSTOMERS_CSEA_52;
DESC ORDERS_CSEA_52;
INSERT INTO ORDERS_CSEA_52 VALUES(3000,1001,2003,1,'22-jan-2012');
INSERT INTO ORDERS_CSEA_52 VALUES(3001,1002,2000,2,'06-aug-2018');
INSERT INTO ORDERS_CSEA_52 VALUES(3002,1000,2002,2,'27-sep-2013');
INSERT INTO ORDERS_CSEA_52 VALUES(3003,1003,2003,1,'06-jun-2011');
INSERT INTO ORDERS_CSEA_52 VALUES(3004,1002,2000,3,'27-oct-2020');
SELECT * FROM ORDERS_CSEA_52;
DESC DELIVERY_CSEA_52;
INSERT INTO DELIVERY_CSEA_52 VALUES(4000,2003,3000);
INSERT INTO DELIVERY_CSEA_52 VALUES(4001,2000,3001);
INSERT INTO DELIVERY_CSEA_52 VALUES(4002,2000,3004);
SELECT * FROM DELIVERY_CSEA_52;


SELECT * FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID;


SELECT * FROM CUSTOMERS_CSEA_52 JOIN DELIVERY_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=DELIVERY_CSEA_52.CUSTID;


SELECT ORDERDATE FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID WHERE CUSTNAME LIKE 'J%';


SELECT ITEMNAME,PRICE FROM ITEMS_CSEA_52 WHERE ITEMID=(SELECT ITEMID FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID WHERE CUSTNAME like 'Mickey%');


SELECT * FROM CUSTOMERS_CSEA_52 WHERE CUSTID IN(SELECT O.CUSTID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID WHERE O.ORDERDATE>'31-JAN-2013' AND D.DELIVERYID IS NULL);


SELECT DISTINCT ITEMID FROM ORDERS_CSEA_52 UNION SELECT DISTINCT O.ITEMID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID WHERE D.DELIVERYID IS NULL;


SELECT CUSTNAME FROM CUSTOMERS_CSEA_52 WHERE CUSTID IN(SELECT O.CUSTID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID WHERE D.DELIVERYID IS NOT NULL);


SELECT CUSTOMERS_CSEA_52.CUSTNAME FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID WHERE ORDERS_CSEA_52.ORDERID IN(SELECT O.ORDERID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID MINUS SELECT O.ORDERID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID WHERE D.DELIVERYID IS NOT NULL);
SELECT CUSTOMERS_CSEA_52.CUSTNAME FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID WHERE ORDERS_CSEA_52.ORDERID IN(SELECT O.ORDERID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID INTERSECT SELECT O.ORDERID FROM ORDERS_CSEA_52 O LEFT JOIN DELIVERY_CSEA_52 D ON O.ORDERID=D.ORDERID WHERE D.DELIVERYID IS NULL);


SELECT CUSTNAME FROM CUSTOMERS_CSEA_52 WHERE CUSTID IN(SELECT MAX(ORDERS_CSEA_52.CUSTID) FROM CUSTOMERS_CSEA_52 JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID);


SELECT * FROM CUSTOMERS_CSEA_52 WHERE CUSTID IN(SELECT O.CUSTID FROM ITEMS_CSEA_52 I JOIN ORDERS_CSEA_52 O ON I.ITEMID=O.ITEMID WHERE I.PRICE>5000);


SELECT CUSTNAME,ADDRESS FROM CUSTOMERS_CSEA_52 WHERE CUSTID IN(SELECT O.CUSTID FROM ITEMS_CSEA_52 I JOIN ORDERS_CSEA_52 O ON I.ITEMID=O.ITEMID WHERE I.ITEMNAME!='Samsung Galaxy S4');


SELECT * FROM CUSTOMERS_CSEA_52 LEFT JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID;
SELECT * FROM CUSTOMERS_CSEA_52 RIGHT JOIN ORDERS_CSEA_52 ON CUSTOMERS_CSEA_52.CUSTID=ORDERS_CSEA_52.CUSTID;


SELECT * FROM CUSTOMERS_CSEA_52 WHERE STATE IN(SELECT STATE FROM CUSTOMERS_CSEA_52 GROUP BY STATE);


SELECT CATEGORY,ITEMID,ITEMNAME,PRICE FROM ITEMS_CSEA_52 WHERE PRICE>(SELECT AVG(PRICE)FROM ITEMS_CSEA_52)GROUP BY CATEGORY,ITEMID,ITEMNAME,PRICE;



COMMIT;